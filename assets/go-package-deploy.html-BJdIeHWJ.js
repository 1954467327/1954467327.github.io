import{_ as a,c as n,a as e,o as l}from"./app-BrotdA_G.js";const i={};function p(t,s){return l(),n("div",null,[...s[0]||(s[0]=[e(`<h1 id="go项目打包以及部署" tabindex="-1"><a class="header-anchor" href="#go项目打包以及部署"><span>Go项目打包以及部署</span></a></h1><h2 id="go语言项目如何打包" tabindex="-1"><a class="header-anchor" href="#go语言项目如何打包"><span>go语言项目如何打包</span></a></h2><h3 id="_1-先查看go环境变量" tabindex="-1"><a class="header-anchor" href="#_1-先查看go环境变量"><span>1. 先查看go环境变量</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">litong@Mac uniweb-os %   go <span class="token function">env</span></span>
<span class="line"><span class="token assign-left variable">AR</span><span class="token operator">=</span><span class="token string">&#39;ar&#39;</span></span>
<span class="line"><span class="token assign-left variable">CC</span><span class="token operator">=</span><span class="token string">&#39;clang&#39;</span></span>
<span class="line"><span class="token assign-left variable">CGO_CFLAGS</span><span class="token operator">=</span><span class="token string">&#39;-O2 -g&#39;</span></span>
<span class="line"><span class="token assign-left variable">CGO_CPPFLAGS</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"><span class="token assign-left variable">CGO_CXXFLAGS</span><span class="token operator">=</span><span class="token string">&#39;-O2 -g&#39;</span></span>
<span class="line"><span class="token assign-left variable">CGO_ENABLED</span><span class="token operator">=</span><span class="token string">&#39;1&#39;</span></span>
<span class="line"><span class="token assign-left variable">CGO_FFLAGS</span><span class="token operator">=</span><span class="token string">&#39;-O2 -g&#39;</span></span>
<span class="line"><span class="token assign-left variable">CGO_LDFLAGS</span><span class="token operator">=</span><span class="token string">&#39;-O2 -g&#39;</span></span>
<span class="line"><span class="token assign-left variable">CXX</span><span class="token operator">=</span><span class="token string">&#39;clang++&#39;</span></span>
<span class="line"><span class="token assign-left variable">GCCGO</span><span class="token operator">=</span><span class="token string">&#39;gccgo&#39;</span></span>
<span class="line"><span class="token assign-left variable">GO111MODULE</span><span class="token operator">=</span><span class="token string">&#39;on&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOARCH</span><span class="token operator">=</span><span class="token string">&#39;arm64&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOARM64</span><span class="token operator">=</span><span class="token string">&#39;v8.0&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOAUTH</span><span class="token operator">=</span><span class="token string">&#39;netrc&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOBIN</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOCACHE</span><span class="token operator">=</span><span class="token string">&#39;/Users/litong/Library/Caches/go-build&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOCACHEPROG</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"><span class="token assign-left variable">GODEBUG</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOENV</span><span class="token operator">=</span><span class="token string">&#39;/Users/litong/Library/Application Support/go/env&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOEXE</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOEXPERIMENT</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOFIPS140</span><span class="token operator">=</span><span class="token string">&#39;off&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOFLAGS</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOGCCFLAGS</span><span class="token operator">=</span><span class="token string">&#39;-fPIC -arch arm64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -ffile-prefix-map=/var/folders/wb/rhm_2yjd7gz219srmfb1wy_40000gn/T/go-build609036225=/tmp/go-build -gno-record-gcc-switches -fno-common&#39;</span></span>
<span class="line"><span class="token comment"># go build 的时候默认会根据这两个字段来打包</span></span>
<span class="line"><span class="token assign-left variable">GOHOSTARCH</span><span class="token operator">=</span><span class="token string">&#39;arm64&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOHOSTOS</span><span class="token operator">=</span><span class="token string">&#39;darwin&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token assign-left variable">GOINSECURE</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOMOD</span><span class="token operator">=</span><span class="token string">&#39;/Users/litong/GolandProjects/uniweb-os/go.mod&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOMODCACHE</span><span class="token operator">=</span><span class="token string">&#39;/Users/litong/go/pkg/mod&#39;</span></span>
<span class="line"><span class="token assign-left variable">GONOPROXY</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"><span class="token assign-left variable">GONOSUMDB</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-进入项目目录-执行go-build-main-go" tabindex="-1"><a class="header-anchor" href="#_2-进入项目目录-执行go-build-main-go"><span>2. 进入项目目录，执行go build main.go</span></a></h3><p>系统架构：GOHOSTARCH=&#39;arm64&#39; 操作系统类型：GOHOSTOS=&#39;darwin&#39; go会在当前目录根据环境变量自动生成可执行文件，如：main；可以通过sh main 执行即可。</p><h4 id="如果需要选择系统架构打包-可以自定义指定" tabindex="-1"><a class="header-anchor" href="#如果需要选择系统架构打包-可以自定义指定"><span>如果需要选择系统架构打包，可以自定义指定：</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token comment"># 交叉编译</span></span>
<span class="line"><span class="token assign-left variable">GOOS</span><span class="token operator">=</span>linux <span class="token assign-left variable">GOARCH</span><span class="token operator">=</span>amd64 go build <span class="token parameter variable">-o</span> app-linux main.go</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="查看go支持架构-go-tool-dist-list" tabindex="-1"><a class="header-anchor" href="#查看go支持架构-go-tool-dist-list"><span>查看go支持架构:go tool dist list</span></a></h4><p>&lt;操作系统&gt;/&lt;架构&gt;</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">litong@Mac ~ % go tool dist list</span>
<span class="line">aix/ppc64</span>
<span class="line">android/386</span>
<span class="line">android/amd64</span>
<span class="line">android/arm</span>
<span class="line">android/arm64</span>
<span class="line">darwin/amd64</span>
<span class="line">darwin/arm64</span>
<span class="line">dragonfly/amd64</span>
<span class="line">freebsd/386</span>
<span class="line">freebsd/amd64</span>
<span class="line">freebsd/arm</span>
<span class="line">freebsd/arm64</span>
<span class="line">freebsd/riscv64</span>
<span class="line"><span class="token punctuation">..</span>.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="go调度器三层结构" tabindex="-1"><a class="header-anchor" href="#go调度器三层结构"><span>Go调度器三层结构</span></a></h2><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line"># GMP模型</span>
<span class="line">┌─────────────┐    ┌──────────────┐    ┌─────────────┐</span>
<span class="line">│   G (协程)   │◄──►│  P (逻辑处理器) │◄──►│  M (系统线程) │</span>
<span class="line">│  - 轻量级    │    │  - 执行上下文  │    │  - 内核线程  │</span>
<span class="line">│  - 用户态    │    │  - 数量=GOMAXPROCS│    │  - 内核态    │</span>
<span class="line">│  - 百万级    │    │  - 调度资源    │    │  - 千级      │</span>
<span class="line">└─────────────┘    └──────────────┘    └─────────────┘</span>
<span class="line">      │                   │                   │</span>
<span class="line">      │ 1:N               │ 1:N               │ N:M</span>
<span class="line">      │ (多个G绑定到P)     │ (多个P共享M池)     │ (多个M对应P)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>GOMAXPROCS控制P的数量：</li></ol><ul><li>P是逻辑处理器，是调度的基本单位</li><li>默认等于CPU核心数</li><li>决定同时执行的goroutine数量上限</li></ul><ol start="2"><li>P与M的关系：</li></ol><ul><li>每个P必须绑定到一个M才能执行G</li><li>空闲的P会释放其M，需要时再申请新的M</li><li>M的数量通常远小于P的数量</li></ul><ol start="3"><li>G的调度：</li></ol><ul><li>G存储在P的本地队列中</li><li>每个P维护一个本地G队列和一个全局G队列</li><li>G在不同P之间迁移来实现负载均衡</li></ul><h2 id="运行时参数" tabindex="-1"><a class="header-anchor" href="#运行时参数"><span>运行时参数</span></a></h2><h3 id="设置gomaxprocs" tabindex="-1"><a class="header-anchor" href="#设置gomaxprocs"><span>设置GOMAXPROCS</span></a></h3><ul><li>GOMAXPROCS控制Go运行时使用的逻辑处理器（P）数量，直接影响程序的并行能力</li><li>它决定了Go调度器可以同时运行的goroutine数量上限</li><li>默认情况下，Go 1.5+ 版本会自动设置为CPU核心数</li></ul><p>GOMAXPROCS=4 ./myapp</p><h3 id="内存限制" tabindex="-1"><a class="header-anchor" href="#内存限制"><span>内存限制</span></a></h3><ul><li>容器内存限制的80%</li><li>系统内存的75% GOMEMLIMIT=512MiB ./myapp</li></ul><h3 id="cpu性能分析" tabindex="-1"><a class="header-anchor" href="#cpu性能分析"><span>CPU性能分析</span></a></h3><p>./myapp -cpuprofile=cpu.prof</p><h3 id="内存分析" tabindex="-1"><a class="header-anchor" href="#内存分析"><span>内存分析</span></a></h3><p>./myapp -memprofile=mem.prof</p><h2 id="部署" tabindex="-1"><a class="header-anchor" href="#部署"><span>部署</span></a></h2><ol><li>可以通过docker进行部署</li><li>通过systemctl操作系统管理部署</li><li>后台执行： <strong>nohup 可执行文件 &amp;</strong> ；</li></ol>`,31)])])}const o=a(i,[["render",p]]),c=JSON.parse(`{"path":"/posts/go-package-deploy.html","title":"Go项目打包以及部署","lang":"zh-CN","frontmatter":{"lang":"zh-CN","title":"Go项目打包以及部署","description":"本文章讲述Go项目如何打包，以及打包后需要如何部署运行","date":"2026-01-20T00:00:00.000Z","category":["后端"],"tag":["部署","Goland"]},"headers":[{"level":2,"title":"go语言项目如何打包","slug":"go语言项目如何打包","link":"#go语言项目如何打包","children":[{"level":3,"title":"1. 先查看go环境变量","slug":"_1-先查看go环境变量","link":"#_1-先查看go环境变量","children":[]},{"level":3,"title":"2. 进入项目目录，执行go build main.go","slug":"_2-进入项目目录-执行go-build-main-go","link":"#_2-进入项目目录-执行go-build-main-go","children":[]}]},{"level":2,"title":"Go调度器三层结构","slug":"go调度器三层结构","link":"#go调度器三层结构","children":[]},{"level":2,"title":"运行时参数","slug":"运行时参数","link":"#运行时参数","children":[{"level":3,"title":"设置GOMAXPROCS","slug":"设置gomaxprocs","link":"#设置gomaxprocs","children":[]},{"level":3,"title":"内存限制","slug":"内存限制","link":"#内存限制","children":[]},{"level":3,"title":"CPU性能分析","slug":"cpu性能分析","link":"#cpu性能分析","children":[]},{"level":3,"title":"内存分析","slug":"内存分析","link":"#内存分析","children":[]}]},{"level":2,"title":"部署","slug":"部署","link":"#部署","children":[]}],"git":{"updatedTime":1769053943000,"contributors":[{"name":"litong","username":"litong","email":"litong@leagsoft.com","commits":1,"url":"https://github.com/litong"}],"changelog":[{"hash":"32ca61135aa57ee6364ed2f3ab3cd3f5aceb2317","time":1769053943000,"email":"litong@leagsoft.com","author":"litong","message":"新增：更新文档"}]},"filePathRelative":"posts/go-package-deploy.md","excerpt":"\\n<h2>go语言项目如何打包</h2>\\n<h3>1. 先查看go环境变量</h3>\\n<div class=\\"language-bash line-numbers-mode\\" data-highlighter=\\"prismjs\\" data-ext=\\"sh\\"><pre><code><span class=\\"line\\">litong@Mac uniweb-os %   go <span class=\\"token function\\">env</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">AR</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'ar'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">CC</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'clang'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">CGO_CFLAGS</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'-O2 -g'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">CGO_CPPFLAGS</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">''</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">CGO_CXXFLAGS</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'-O2 -g'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">CGO_ENABLED</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'1'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">CGO_FFLAGS</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'-O2 -g'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">CGO_LDFLAGS</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'-O2 -g'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">CXX</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'clang++'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GCCGO</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'gccgo'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GO111MODULE</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'on'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GOARCH</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'arm64'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GOARM64</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'v8.0'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GOAUTH</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'netrc'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GOBIN</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">''</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GOCACHE</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'/Users/litong/Library/Caches/go-build'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GOCACHEPROG</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">''</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GODEBUG</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">''</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GOENV</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'/Users/litong/Library/Application Support/go/env'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GOEXE</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">''</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GOEXPERIMENT</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">''</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GOFIPS140</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'off'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GOFLAGS</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">''</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GOGCCFLAGS</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'-fPIC -arch arm64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -ffile-prefix-map=/var/folders/wb/rhm_2yjd7gz219srmfb1wy_40000gn/T/go-build609036225=/tmp/go-build -gno-record-gcc-switches -fno-common'</span></span>\\n<span class=\\"line\\"><span class=\\"token comment\\"># go build 的时候默认会根据这两个字段来打包</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GOHOSTARCH</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'arm64'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GOHOSTOS</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'darwin'</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GOINSECURE</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">''</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GOMOD</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'/Users/litong/GolandProjects/uniweb-os/go.mod'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GOMODCACHE</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">'/Users/litong/go/pkg/mod'</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GONOPROXY</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">''</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">GONOSUMDB</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">''</span></span>\\n<span class=\\"line\\"></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>"}`);export{o as comp,c as data};
