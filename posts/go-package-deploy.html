<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.20" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>Go项目打包以及部署 | 未之离忧</title><meta name="description" content="本文章讲述Go项目如何打包，以及打包后需要如何部署运行">
    <link rel="preload" href="/assets/style-iEG9IkOu.css" as="style"><link rel="stylesheet" href="/assets/style-iEG9IkOu.css">
    <link rel="modulepreload" href="/assets/app-BrotdA_G.js"><link rel="modulepreload" href="/assets/go-package-deploy.html-BJdIeHWJ.js">
    <link rel="prefetch" href="/assets/index.html-Bo_Yt1hl.js" as="script"><link rel="prefetch" href="/assets/get-started.html-K9maPBv-.js" as="script"><link rel="prefetch" href="/assets/article-error-code.html-CGCvPrsb.js" as="script"><link rel="prefetch" href="/assets/go-inherit.html-BT6np1F4.js" as="script"><link rel="prefetch" href="/assets/go-packaging.html-DcOUZ2Pu.js" as="script"><link rel="prefetch" href="/assets/go-polymorphic.html-OPaCvATm.js" as="script"><link rel="prefetch" href="/assets/linux-mutual-trust.html-CouBR6Oc.js" as="script"><link rel="prefetch" href="/assets/logfile-search.html-CQ8CGRCA.js" as="script"><link rel="prefetch" href="/assets/mobile-h5.html-BaMjQaTC.js" as="script"><link rel="prefetch" href="/assets/postgres-slow-sql.html-CZdSbCwD.js" as="script"><link rel="prefetch" href="/assets/404.html-C04HZS95.js" as="script"><link rel="prefetch" href="/assets/index.html-Dilf0yZ1.js" as="script"><link rel="prefetch" href="/assets/index.html-6TNCeLFL.js" as="script"><link rel="prefetch" href="/assets/index.html-DIXHEfC5.js" as="script"><link rel="prefetch" href="/assets/index.html-CpCwtlBJ.js" as="script"><link rel="prefetch" href="/assets/index.html-Loe3lBM-.js" as="script"><link rel="prefetch" href="/assets/index.html-C64a76C7.js" as="script"><link rel="prefetch" href="/assets/index.html-D1uHg72Y.js" as="script"><link rel="prefetch" href="/assets/index.html-CBgi7SHp.js" as="script"><link rel="prefetch" href="/assets/index.html-B_Su8Q0A.js" as="script"><link rel="prefetch" href="/assets/index.html-Bgt8EWxm.js" as="script"><link rel="prefetch" href="/assets/index.html-DGhjJlm9.js" as="script"><link rel="prefetch" href="/assets/index.html-DhxbB_IE.js" as="script"><link rel="prefetch" href="/assets/index.html-CyUuXQ48.js" as="script"><link rel="prefetch" href="/assets/index.html-Dj1Av5VU.js" as="script"><link rel="prefetch" href="/assets/index.html-BPp00sC1.js" as="script"><link rel="prefetch" href="/assets/index.html-Z0XaRDyt.js" as="script"><link rel="prefetch" href="/assets/index.html-C4gL0uxD.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="vp-site-logo" src="/logo.png" alt="未之离忧"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">未之离忧</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="主页"><!--[--><!--[--><!--]--><!--]-->主页<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/article/" aria-label="文章"><!--[--><!--[--><!--]--><!--]-->文章<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/category/" aria-label="分类"><!--[--><!--[--><!--]--><!--]-->分类<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/tag/" aria-label="标签"><!--[--><!--[--><!--]--><!--]-->标签<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/timeline/" aria-label="时间线"><!--[--><!--[--><!--]--><!--]-->时间线<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="主页"><!--[--><!--[--><!--]--><!--]-->主页<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/article/" aria-label="文章"><!--[--><!--[--><!--]--><!--]-->文章<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/category/" aria-label="分类"><!--[--><!--[--><!--]--><!--]-->分类<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/tag/" aria-label="标签"><!--[--><!--[--><!--]--><!--]-->标签<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/timeline/" aria-label="时间线"><!--[--><!--[--><!--]--><!--]-->时间线<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Go项目打包以及部署 <!----></p><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><h1 id="go项目打包以及部署" tabindex="-1"><a class="header-anchor" href="#go项目打包以及部署"><span>Go项目打包以及部署</span></a></h1><h2 id="go语言项目如何打包" tabindex="-1"><a class="header-anchor" href="#go语言项目如何打包"><span>go语言项目如何打包</span></a></h2><h3 id="_1-先查看go环境变量" tabindex="-1"><a class="header-anchor" href="#_1-先查看go环境变量"><span>1. 先查看go环境变量</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">litong@Mac uniweb-os %   go <span class="token function">env</span></span>
<span class="line"><span class="token assign-left variable">AR</span><span class="token operator">=</span><span class="token string">&#39;ar&#39;</span></span>
<span class="line"><span class="token assign-left variable">CC</span><span class="token operator">=</span><span class="token string">&#39;clang&#39;</span></span>
<span class="line"><span class="token assign-left variable">CGO_CFLAGS</span><span class="token operator">=</span><span class="token string">&#39;-O2 -g&#39;</span></span>
<span class="line"><span class="token assign-left variable">CGO_CPPFLAGS</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"><span class="token assign-left variable">CGO_CXXFLAGS</span><span class="token operator">=</span><span class="token string">&#39;-O2 -g&#39;</span></span>
<span class="line"><span class="token assign-left variable">CGO_ENABLED</span><span class="token operator">=</span><span class="token string">&#39;1&#39;</span></span>
<span class="line"><span class="token assign-left variable">CGO_FFLAGS</span><span class="token operator">=</span><span class="token string">&#39;-O2 -g&#39;</span></span>
<span class="line"><span class="token assign-left variable">CGO_LDFLAGS</span><span class="token operator">=</span><span class="token string">&#39;-O2 -g&#39;</span></span>
<span class="line"><span class="token assign-left variable">CXX</span><span class="token operator">=</span><span class="token string">&#39;clang++&#39;</span></span>
<span class="line"><span class="token assign-left variable">GCCGO</span><span class="token operator">=</span><span class="token string">&#39;gccgo&#39;</span></span>
<span class="line"><span class="token assign-left variable">GO111MODULE</span><span class="token operator">=</span><span class="token string">&#39;on&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOARCH</span><span class="token operator">=</span><span class="token string">&#39;arm64&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOARM64</span><span class="token operator">=</span><span class="token string">&#39;v8.0&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOAUTH</span><span class="token operator">=</span><span class="token string">&#39;netrc&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOBIN</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOCACHE</span><span class="token operator">=</span><span class="token string">&#39;/Users/litong/Library/Caches/go-build&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOCACHEPROG</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"><span class="token assign-left variable">GODEBUG</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOENV</span><span class="token operator">=</span><span class="token string">&#39;/Users/litong/Library/Application Support/go/env&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOEXE</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOEXPERIMENT</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOFIPS140</span><span class="token operator">=</span><span class="token string">&#39;off&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOFLAGS</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOGCCFLAGS</span><span class="token operator">=</span><span class="token string">&#39;-fPIC -arch arm64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -ffile-prefix-map=/var/folders/wb/rhm_2yjd7gz219srmfb1wy_40000gn/T/go-build609036225=/tmp/go-build -gno-record-gcc-switches -fno-common&#39;</span></span>
<span class="line"><span class="token comment"># go build 的时候默认会根据这两个字段来打包</span></span>
<span class="line"><span class="token assign-left variable">GOHOSTARCH</span><span class="token operator">=</span><span class="token string">&#39;arm64&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOHOSTOS</span><span class="token operator">=</span><span class="token string">&#39;darwin&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token assign-left variable">GOINSECURE</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOMOD</span><span class="token operator">=</span><span class="token string">&#39;/Users/litong/GolandProjects/uniweb-os/go.mod&#39;</span></span>
<span class="line"><span class="token assign-left variable">GOMODCACHE</span><span class="token operator">=</span><span class="token string">&#39;/Users/litong/go/pkg/mod&#39;</span></span>
<span class="line"><span class="token assign-left variable">GONOPROXY</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"><span class="token assign-left variable">GONOSUMDB</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-进入项目目录-执行go-build-main-go" tabindex="-1"><a class="header-anchor" href="#_2-进入项目目录-执行go-build-main-go"><span>2. 进入项目目录，执行go build main.go</span></a></h3><p>系统架构：GOHOSTARCH=&#39;arm64&#39; 操作系统类型：GOHOSTOS=&#39;darwin&#39; go会在当前目录根据环境变量自动生成可执行文件，如：main；可以通过sh main 执行即可。</p><h4 id="如果需要选择系统架构打包-可以自定义指定" tabindex="-1"><a class="header-anchor" href="#如果需要选择系统架构打包-可以自定义指定"><span>如果需要选择系统架构打包，可以自定义指定：</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token comment"># 交叉编译</span></span>
<span class="line"><span class="token assign-left variable">GOOS</span><span class="token operator">=</span>linux <span class="token assign-left variable">GOARCH</span><span class="token operator">=</span>amd64 go build <span class="token parameter variable">-o</span> app-linux main.go</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="查看go支持架构-go-tool-dist-list" tabindex="-1"><a class="header-anchor" href="#查看go支持架构-go-tool-dist-list"><span>查看go支持架构:go tool dist list</span></a></h4><p>&lt;操作系统&gt;/&lt;架构&gt;</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">litong@Mac ~ % go tool dist list</span>
<span class="line">aix/ppc64</span>
<span class="line">android/386</span>
<span class="line">android/amd64</span>
<span class="line">android/arm</span>
<span class="line">android/arm64</span>
<span class="line">darwin/amd64</span>
<span class="line">darwin/arm64</span>
<span class="line">dragonfly/amd64</span>
<span class="line">freebsd/386</span>
<span class="line">freebsd/amd64</span>
<span class="line">freebsd/arm</span>
<span class="line">freebsd/arm64</span>
<span class="line">freebsd/riscv64</span>
<span class="line"><span class="token punctuation">..</span>.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="go调度器三层结构" tabindex="-1"><a class="header-anchor" href="#go调度器三层结构"><span>Go调度器三层结构</span></a></h2><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line"># GMP模型</span>
<span class="line">┌─────────────┐    ┌──────────────┐    ┌─────────────┐</span>
<span class="line">│   G (协程)   │◄──►│  P (逻辑处理器) │◄──►│  M (系统线程) │</span>
<span class="line">│  - 轻量级    │    │  - 执行上下文  │    │  - 内核线程  │</span>
<span class="line">│  - 用户态    │    │  - 数量=GOMAXPROCS│    │  - 内核态    │</span>
<span class="line">│  - 百万级    │    │  - 调度资源    │    │  - 千级      │</span>
<span class="line">└─────────────┘    └──────────────┘    └─────────────┘</span>
<span class="line">      │                   │                   │</span>
<span class="line">      │ 1:N               │ 1:N               │ N:M</span>
<span class="line">      │ (多个G绑定到P)     │ (多个P共享M池)     │ (多个M对应P)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>GOMAXPROCS控制P的数量：</li></ol><ul><li>P是逻辑处理器，是调度的基本单位</li><li>默认等于CPU核心数</li><li>决定同时执行的goroutine数量上限</li></ul><ol start="2"><li>P与M的关系：</li></ol><ul><li>每个P必须绑定到一个M才能执行G</li><li>空闲的P会释放其M，需要时再申请新的M</li><li>M的数量通常远小于P的数量</li></ul><ol start="3"><li>G的调度：</li></ol><ul><li>G存储在P的本地队列中</li><li>每个P维护一个本地G队列和一个全局G队列</li><li>G在不同P之间迁移来实现负载均衡</li></ul><h2 id="运行时参数" tabindex="-1"><a class="header-anchor" href="#运行时参数"><span>运行时参数</span></a></h2><h3 id="设置gomaxprocs" tabindex="-1"><a class="header-anchor" href="#设置gomaxprocs"><span>设置GOMAXPROCS</span></a></h3><ul><li>GOMAXPROCS控制Go运行时使用的逻辑处理器（P）数量，直接影响程序的并行能力</li><li>它决定了Go调度器可以同时运行的goroutine数量上限</li><li>默认情况下，Go 1.5+ 版本会自动设置为CPU核心数</li></ul><p>GOMAXPROCS=4 ./myapp</p><h3 id="内存限制" tabindex="-1"><a class="header-anchor" href="#内存限制"><span>内存限制</span></a></h3><ul><li>容器内存限制的80%</li><li>系统内存的75% GOMEMLIMIT=512MiB ./myapp</li></ul><h3 id="cpu性能分析" tabindex="-1"><a class="header-anchor" href="#cpu性能分析"><span>CPU性能分析</span></a></h3><p>./myapp -cpuprofile=cpu.prof</p><h3 id="内存分析" tabindex="-1"><a class="header-anchor" href="#内存分析"><span>内存分析</span></a></h3><p>./myapp -memprofile=mem.prof</p><h2 id="部署" tabindex="-1"><a class="header-anchor" href="#部署"><span>部署</span></a></h2><ol><li>可以通过docker进行部署</li><li>通过systemctl操作系统管理部署</li><li>后台执行： <strong>nohup 可执行文件 &amp;</strong> ；</li></ol></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">最近更新：: </span><time class="meta-item-info" datetime="2026-01-22T03:52:23.000Z" data-allow-mismatch>2026/1/22 03:52</time></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: litong@leagsoft.com">litong</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BrotdA_G.js" defer></script>
  </body>
</html>
